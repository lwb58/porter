version: '3'
services:

  porter:
    image: python:naruto
    working_dir: "/root/porter"
    command: sh run.sh
    volumes: 
      - "/root/github/porter:/root/porter"
      - "/root/github/fuck_sina:/root/fuck_sina"
      - "/root/github/fuck_intl:/root/fuck_intl"
      - "/root/github/fuck_bilibili:/root/fuck_bilibili"
      - "/root/github/movpy:/root/movpy"
    deploy:
      replicas: 1
      restart_policy:
        condition: any
      resources:
        limits:
          memory: 1000M
        

  redis:
    image: redis
    container_name: redis
    hostname: redis
    environment:
      - "TZ=Asia/Shanghai"
    volumes:
      - "./data/data:/data"
      - "./data/redis.conf:/etc/redis.conf"
    ports: 
      - "6379:6379"
    deploy:
      replicas: 1
      restart_policy:
        condition: any
      resources:
        limits:
          memory: 200M